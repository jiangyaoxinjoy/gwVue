(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-67794975"],{"00d8":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.loading?n("Spin",{attrs:{size:"large",fix:""}}):t._e(),n("baidu-map",{staticClass:"bm-view",style:{height:t.mapHeight+"px"},attrs:{ak:"QPPRPzUYlpEqGNkyylz2OuTBQCeWVHAd",center:{lng:t.centerMark.lng,lat:t.centerMark.lat},zoom:t.zoom,"min-zoom":16,"scroll-wheel-zoom":!0},on:{ready:t.map_handler,moveend:t.mapMoveend}},[n("p",[n("router-link",{attrs:{to:{name:"statusData"}}},[n("Button",{attrs:{type:"text",icon:"ios-arrow-back"}},[t._v("返回")])],1),n("Button",{attrs:{type:"text",icon:"md-share-alt"},on:{click:t.resetMap}},[t._v("恢复视图")])],1),n("bm-view",{style:{flex:1,height:t.mapInnerHeight+"px",width:"100%"}}),n("bml-marker-clusterer",{attrs:{averageCenter:!0}},t._l(t.markersData,function(e){return n("bm-marker",{key:e.Id,attrs:{icon:{url:"70"==e.state||"80"==e.state?"/images/locationE.svg":"/images/locationP.svg",size:{width:30,height:30}},position:{lng:e.lng,lat:e.lat}},on:{click:function(n){return t.showInfo(e)}}})}),1),n("bm-info-window",{attrs:{position:{lng:t.infoWindow.lng,lat:t.infoWindow.lat},show:t.infoWindowShow,width:0,height:0,autoPan:!0},on:{close:t.infoWindowClose,open:t.infoWindowOpen}},[n("div",{staticClass:"info_title"},[n("Tag",{attrs:{type:"dot",color:t.stateColor}},[t._v(t._s(t._f("filterStateText")(t.infoWindow.state)))]),n("span",[t._v(t._s(t.infoWindow.device_id))])],1),n("p",{domProps:{textContent:t._s(t.infoWindow.address)}})])],1)],1)},a=[],o=n("e20c"),r=n("591a"),s=n("ad5d"),d=n("4878"),c={name:"fullMap",components:{BmlMarkerClusterer:d["BmlMarkerClusterer"],BaiduMap:s["a"],BmMarker:d["BmMarker"],BmInfoWindow:d["BmInfoWindow"],BmView:d["BmView"]},filters:{filterStateText:function(t){return"70"===t?"异常":"80"===t?"故障":"在线"}},data:function(){return{infoPosition:{},zoom:16,infoWindowShow:!1,infoWindow:{},pointsView:[],markers:[],markersData:[],loading:!0,flag:!1}},created:function(){0===this.centerMark.lng&&this.$router.push({path:"data"})},watch:{deviceParams:{handler:function(){this.loading=!0,this.addMarker()},deep:!0}},computed:Object(o["a"])({},Object(r["c"])(["deviceParams"]),Object(r["e"])({centerMark:function(t){return t.device.centerMark}}),{stateColor:function(){return"70"!==this.infoWindow.state&&"80"!==this.infoWindow.state?"success":"error"},mapHeight:function(){return this.$store.state.user.windowH},mapInnerHeight:function(){return this.mapHeight-35}}),methods:Object(o["a"])({},Object(r["b"])(["deviceMapList"]),{map_handler:function(t){var e=t.BMap,n=t.map;this.BMap=e,this.map=n,n.enableScrollWheelZoom(),n.enableContinuousZoom(),this.addMarker()},showInfo:function(t){this.infoWindow=t,this.infoWindowShow=!0},addMarker:function(){if(!this.BMap)return!1;var t=this.map,e=t.getBounds();this.deviceParams.minLatitude=e.getSouthWest().lat,this.deviceParams.maxLatitude=e.getNorthEast().lat,this.deviceParams.minLongitude=e.getSouthWest().lng,this.deviceParams.maxLongitude=e.getNorthEast().lng,this.infoWindowClose(),this.getMapDeviceList()},infoWindowClose:function(t){this.infoWindowShow=!1},infoWindowOpen:function(t){this.infoWindowShow=!0},resetMap:function(){this.loading=!0;var t=this.map;t.centerAndZoom(new BMap.Point(this.centerMark.lng,this.centerMark.lat),this.zoom)},clickHandler:function(t){this.infoWindowShow=!0},getMapDeviceList:function(){var t=this;this.deviceMapList(this.deviceParams).then(function(e){t.markersData=null===e.data?[]:e.data,setTimeout(function(){t.loading=!1},500),t.flag=!1})},mapMoveend:function(){this.flag||(this.flag=!0,this.addMarker())}})},l=c,h=(n("a1d3"),n("17cc")),u=Object(h["a"])(l,i,a,!1,null,"4de8c3b3",null);e["default"]=u.exports},"4c4d":function(t,e,n){},a1d3:function(t,e,n){"use strict";var i=n("4c4d"),a=n.n(i);a.a}}]);